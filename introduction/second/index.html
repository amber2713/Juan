<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å¼€å­¦è‡ªæˆ‘ä»‹ç» Â· äº’åŠ¨ç½‘ç«™</title>
  <style>
    :root{
      --bg:#f7fafc;        /* æ¸©æŸ”æ ¡å›­ç°ç™½ */
      --ink:#243b53;       /* æ·±è“ç°æ–‡å­— */
      --accent:#4f46e5;    /* æ ¡å›­æ¸…æ–°è“ç´« */
      --accent-2:#10b981;  /* æ´»åŠ›ç»¿ */
      --muted:#94a3b8;     /* æ¬¡è¦æ–‡æœ¬ */
      --card:#ffffff;      /* å¡ç‰‡åº•è‰² */
      --shadow:0 20px 50px rgba(0,0,0,.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0; font-family: "PingFang SC", "Microsoft YaHei", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color:var(--ink); background:linear-gradient(180deg,#eef2ff, #f9fafb 55% , #e6fffa);
      overflow:hidden;
    }

    /* åœºæ™¯å®¹å™¨ï¼ˆåš 3D ç¿»è½¬è½¬åœºï¼‰ */
    .stage{position:relative; width:100vw; height:100vh; perspective:1400px;}
    .page{
      position:absolute; inset:0; display:grid; place-items:center; background:transparent;
      transform-style:preserve-3d; backface-visibility:hidden; opacity:0; pointer-events:none;
      transition:opacity .6s ease, transform .8s cubic-bezier(.2,.8,.2,1);
    }
    .page.active{opacity:1; pointer-events:auto}
    .page.enter{transform:rotateY(-10deg) translateY(10px) scale(.98)}
    .page.show{transform:rotateY(0) translateY(0) scale(1)}
    .page.exit{transform:rotateY(10deg) translateY(10px) scale(.98); opacity:0}

    /* ä¸»é¡µé¢ï¼šåå­—è·¯å£è§†è§‰ */
    .main-wrap{
      width:min(1100px,92vw); height:min(680px,86vh); background:var(--card); border-radius:28px; box-shadow:var(--shadow);
      display:grid; grid-template-columns: 1fr; grid-template-rows: 90px 1fr; overflow:hidden; position:relative;
    }
    .main-header{display:flex; align-items:center; justify-content:space-between; padding:18px 26px; background:linear-gradient(90deg,#ffffff, #eef2ff); border-bottom:1px solid #e5e7eb}
    .brand{font-weight:700; letter-spacing:.5px}
    .tip{font-size:14px; color:var(--muted)}

    .crossroads{position:relative; width:100%; height:100%; background:linear-gradient(180deg,#f8fafc, #e0f2fe 60%, #d6d3d1 60%);}
    .path{position:absolute; bottom:0; left:50%; transform:translateX(-50%); width:0; height:0;
      border-left:300px solid transparent; border-right:300px solid transparent; border-top:240px solid #d6d3d1; filter:drop-shadow(0 10px 25px rgba(0,0,0,.15));}
    .path.left{left:30%; border-left-width:220px; border-right-width:60px; border-top-color:#d4d4d4;}
    .path.right{left:70%; border-left-width:60px; border-right-width:220px; border-top-color:#d4d4d4;}

    /* å¥³å­©ç®€ç¬”ï¼ˆCSS å½¢çŠ¶è½®å»“ï¼‰ */
    .girl{position:absolute; bottom:150px; left:50%; transform:translateX(-50%); width:110px; height:220px;}
    .girl .body{position:absolute; bottom:0; left:50%; transform:translateX(-50%); width:80px; height:140px; background:#fefefe; border:2px solid #111827; border-radius:18px 18px 28px 28px/28px 28px 36px 36px; box-shadow:0 8px 16px rgba(0,0,0,.08)}
    .girl .head{position:absolute; bottom:140px; left:50%; transform:translateX(-50%); width:88px; height:88px; background:#fde68a; border:2px solid #111827; border-radius:50%;}
    .girl .skirt{position:absolute; bottom:100px; left:50%; transform:translateX(-50%); width:120px; height:80px; background:#a78bfa; border:2px solid #111827; border-radius:50% 50% 10% 10%; filter:blur(.2px)}
    .girl .shadow{position:absolute; bottom:125px; left:50%; transform:translateX(-50%); width:140px; height:16px; background:radial-gradient(ellipse at center, rgba(0,0,0,.2), rgba(0,0,0,0) 60%);}

    /* è·¯ç‰Œ */
    .signs{position:absolute; top:22%; left:50%; transform:translateX(-50%); display:flex; gap:28px; align-items:flex-end}
    .sign{
      position:relative; width:150px; height:70px; background:#ffffff; border:2px solid #111827; border-radius:16px; display:grid; place-items:center; font-weight:700;
      box-shadow:0 12px 24px rgba(0,0,0,.1); cursor:pointer; transition:transform .25s, box-shadow .25s, filter .25s;
    }
    .sign::after{content:""; position:absolute; bottom:-48px; left:50%; transform:translateX(-50%); width:10px; height:48px; background:#111827; border-radius:4px}
    .sign.locked{cursor:not-allowed; filter:grayscale(1) brightness(.9); opacity:.7}
    .sign:hover:not(.locked){transform:translateY(-4px)}
    .sign.active-pulse{animation:pulse 1.2s ease-in-out infinite}
    @keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(79,70,229,.5)}50%{box-shadow:0 0 0 16px rgba(79,70,229,0)}}
    .sign.selected{transform:scale(1.05); box-shadow:0 0 0 6px rgba(16,185,129,.25), 0 10px 30px rgba(0,0,0,.18)}

    /* ç»Ÿä¸€å¡ç‰‡å¸ƒå±€ */
    .card{width:min(1100px,92vw); height:min(680px,86vh); background:var(--card); border-radius:28px; box-shadow:var(--shadow); overflow:hidden; position:relative}
    .card-header{position:absolute; top:0; left:0; right:0; height:60px; display:flex; align-items:center; justify-content:space-between; padding:0 18px; background:linear-gradient(90deg,#ffffff, #f8fafc); border-bottom:1px solid #eef2f7}
    .back-btn{display:none; align-items:center; gap:8px; font-size:14px; color:var(--accent); cursor:pointer; padding:8px 12px; border-radius:999px; border:1px solid rgba(79,70,229,.25); background:#fff; transition:transform .2s}
    .back-btn.show{display:flex}
    .back-btn:hover{transform:translateY(-1px)}

    .page-body{position:absolute; inset:60px 0 0 0; display:grid; grid-template-columns: 1fr 1fr; height:calc(100% - 60px)}

    /* ç°åœ¨é¡µ */
    .now-left{position:relative; overflow:hidden; display:grid; place-items:center; background:linear-gradient(180deg,#f0f9ff, #ecfeff)}
    .now-left img{max-width:88%; max-height:88%; border-radius:20px; box-shadow:0 12px 30px rgba(0,0,0,.12); transition:transform .8s ease, filter .8s ease}
    .now-left img.zoom{transform:scale(1.18); filter:contrast(1.1) saturate(1.05)}

    .now-right{padding:24px 28px; display:flex; flex-direction:column; gap:22px; background:linear-gradient(180deg,#ffffff, #f7faff)}
    .q-title{font-size:28px; font-weight:800}
    .btn-row{display:flex; gap:14px}
    .btn{
      padding:14px 20px; border:none; border-radius:14px; background:var(--accent); color:#fff; font-weight:700; cursor:pointer; box-shadow:0 8px 20px rgba(79,70,229,.25); transition:transform .15s ease, box-shadow .2s ease, filter .2s; user-select:none;
    }
    .btn.secondary{background:#e11d48}
    .btn:active{transform:scale(.96)}

    /* è¡¨æƒ…åŒ…æ°”æ³¡ */
    .toast{position:absolute; right:20px; bottom:20px; padding:10px 14px; background:#fff; border:1px solid #e5e7eb; border-radius:14px; box-shadow:0 10px 20px rgba(0,0,0,.08); opacity:0; transform:translateY(10px); transition:all .35s}
    .toast.show{opacity:1; transform:translateY(0)}

    /* è¿‡å»é¡µ */
    .past-scene{display:none; height:100%}
    .past-scene.show{display:grid}
    .past-s1{grid-template-columns:1fr; place-items:center; padding:40px; background:linear-gradient(180deg,#fff, #f0f9ff)}
    .ask{font-size:26px; font-weight:800; margin-bottom:18px}
    .name-input{padding:14px 16px; width:min(520px,80vw); border-radius:14px; border:2px solid #c7d2fe; font-size:18px; outline:none}
    .hint{margin-top:10px; color:#ef4444; min-height:22px}

    .past-s2{grid-template-columns: 1.1fr .9fr; background:linear-gradient(180deg,#ffffff, #f8fafc)}
    .past-left{padding:24px 28px; display:flex; flex-direction:column; gap:14px}
    .pager{flex:1; border:1px dashed #cbd5e1; border-radius:16px; padding:18px; overflow:hidden; position:relative; background:#fff}
    .page-text{position:absolute; inset:0; padding:20px; font-size:18px; line-height:1.8; opacity:0; transform:translateX(8px); transition:opacity .4s, transform .4s}
    .page-text.active{opacity:1; transform:translateX(0)}
    .page-ctr{display:flex; justify-content:space-between; align-items:center}
    .arrow{padding:10px 14px; border-radius:10px; border:1px solid #cbd5e1; background:#fff; cursor:pointer; transition:transform .2s}
    .arrow:hover{transform:translateY(-1px)}

    .past-right{position:relative; display:grid; place-items:center; overflow:hidden}
    .carousel{position:relative; width:88%; height:80%; border-radius:18px; overflow:hidden; box-shadow:0 12px 30px rgba(0,0,0,.12)}
    .carousel img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; opacity:0; transform:scale(1.06) translateX(20px);
      transition:opacity .8s ease, transform 1s ease}
    .carousel img.show{opacity:1; transform:scale(1) translateX(0)}

    /* å°†æ¥é¡µ */
    .future-bg{position:absolute; inset:0; background: center/cover no-repeat; filter:brightness(.95)}
    .future-wrap{position:relative; width:100%; height:100%; display:grid; place-items:center}
    .typebox{width:min(780px,86vw); min-height:260px; background:rgba(255,255,255,.9); border:1px solid #e5e7eb; border-radius:20px; box-shadow:var(--shadow); padding:24px 26px; position:relative}
    .type{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size:18px; white-space:pre-line; min-height:120px}
    .pass{position:absolute; right:16px; bottom:14px; font-weight:700; color:#111827; border:1px solid #cbd5e1; background:#fff; padding:8px 14px; border-radius:999px; cursor:pointer; display:none}
    .pass.show{display:inline-block}

    .pages5{display:none}
    .pages5.show{display:block}
    .p5-wrap{display:flex; align-items:center; gap:16px}
    .p5-card{flex:1; min-height:160px; border:1px dashed #cbd5e1; border-radius:16px; padding:18px; background:#fff; display:grid; place-items:center; font-size:22px; font-weight:800; text-align:center}
    .p5-arrow{width:44px; height:44px; border-radius:50%; border:1px solid #cbd5e1; background:#fff; display:grid; place-items:center; cursor:pointer; transition:transform .2s}
    .p5-arrow:hover{transform:scale(1.06)}

    /* ç‚¹èµé¡µ */
    .like-wrap{display:none}
    .like-wrap.show{display:grid}
    .like-area{display:grid; place-items:center; gap:18px}
    .heart{font-size:56px; cursor:pointer; user-select:none; transition:transform .15s}
    .heart:active{transform:scale(.94)}
    .count{font-size:38px; font-weight:800}
    .count.bump{animation:bump .25s ease}
    @keyframes bump{0%{transform:translateY(0)}50%{transform:translateY(-4px)}100%{transform:translateY(0)}}

    /* å“åº”å¼ */
    @media (max-width: 900px){
      .page-body{grid-template-columns:1fr}
      .past-s2{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="stage">
    <!-- ä¸»é¡µé¢ -->
    <section id="page-main" class="page active show">
      <div class="main-wrap">
        <div class="main-header">
          <div class="brand">ğŸ‘‹ è‡ªæˆ‘ä»‹ç» Â· Welcome!</div>
          <div class="tip">é€‰æ‹©ä¸€æ¡è·¯ï¼Œäº†è§£æˆ‘çš„ <b>è¿‡å» / ç°åœ¨ / å°†æ¥</b></div>
        </div>
        <div class="crossroads">
          <div class="path left"></div>
          <div class="path"></div>
          <div class="path right"></div>

          <div class="girl">
            <div class="shadow"></div>
            <div class="body"></div>
            <div class="skirt"></div>
            <div class="head"></div>
          </div>

          <div class="signs">
            <div id="sign-past" class="sign locked" data-target="page-past">è¿‡å»</div>
            <div id="sign-now" class="sign active-pulse" data-target="page-now">ç°åœ¨</div>
            <div id="sign-future" class="sign locked" data-target="page-future">å°†æ¥</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ç°åœ¨é¡µ -->
    <section id="page-now" class="page enter">
      <div class="card">
        <div class="card-header">
          <div style="font-weight:700">ç°åœ¨ Â· NOW</div>
          <div id="back-now" class="back-btn">âŸµ è¿”å›ä¸»é¡µé¢</div>
        </div>
        <div class="page-body">
          <div class="now-left">
            <img id="imgA" src="images/A.jpg" alt="A" />
          </div>
          <div class="now-right">
            <div class="q-title">ä½ æƒ³è®¤è¯†æˆ‘å—ï¼Ÿ</div>
            <div class="btn-row">
              <button id="yesBtn" class="btn">æƒ³</button>
              <button id="noBtn" class="btn secondary">ä¸æƒ³</button>
            </div>
            <div style="color:var(--muted)">å°æç¤ºï¼šé€‰æ‹©ä¸åŒï¼Œä¼šè§¦å‘ä¸åŒçš„åŠ¨ç”»å™¢ï½</div>
          </div>
          <div id="toast" class="toast"></div>
        </div>
      </div>
    </section>

    <!-- è¿‡å»é¡µ -->
    <section id="page-past" class="page enter">
      <div class="card">
        <div class="card-header">
          <div style="font-weight:700">è¿‡å» Â· PAST</div>
          <div id="back-past" class="back-btn">âŸµ è¿”å›ä¸»é¡µé¢</div>
        </div>

        <!-- åœºæ™¯ä¸€ï¼šè¾“å…¥åå­— -->
        <div id="past-s1" class="page-body past-scene past-s1 show">
          <div style="display:grid; place-items:center; height:100%">
            <div class="ask">æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ</div>
            <input id="nameInput" class="name-input" placeholder="è¯·è¾“å…¥ï¼šçŸ³æ˜å¨Ÿ" />
            <div id="nameHint" class="hint"></div>
          </div>
        </div>

        <!-- åœºæ™¯äºŒï¼šåˆ†é¡µ + è½®æ’­ -->
        <div id="past-s2" class="page-body past-scene past-s2">
          <div class="past-left">
            <div class="pager">
              <div class="page-text" data-i="0">å—¨ï¼Œæˆ‘ä»å°åœ¨æ ¡å›­é‡Œé•¿å¤§ï¼Œçƒ­çˆ±ç¤¾å›¢æ´»åŠ¨ä¸è®°å½•ç”Ÿæ´»ã€‚</div>
              <div class="page-text" data-i="1">å–œæ¬¢æ‹ç…§ã€è¿åŠ¨å’Œåˆ†äº«æ•…äº‹ï¼Œä¹Ÿæ“…é•¿åšæ´»åŠ¨ç­–åˆ’ã€‚</div>
              <div class="page-text" data-i="2">æ¥åˆ°æ–°çš„ç¯å¢ƒï¼Œæˆ‘å¸Œæœ›å’Œå¤§å®¶æˆä¸ºå½¼æ­¤çš„å…‰ã€‚</div>
            </div>
            <div class="page-ctr">
              <button id="pPrev" class="arrow">âŸµ ä¸Šä¸€é¡µ</button>
              <div id="pIndicator" style="color:var(--muted)">1 / 3</div>
              <button id="pNext" class="arrow">ä¸‹ä¸€é¡µ âŸ¶</button>
            </div>
          </div>
          <div class="past-right">
            <div class="carousel">
              <img id="imgB" src="images/B.jpg" alt="B" />
              <img id="imgC" src="images/C.jpg" alt="C" />
              <img id="imgD" src="images/D.jpg" alt="D" />
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- å°†æ¥é¡µ -->
    <section id="page-future" class="page enter">
      <div class="card" style="background:transparent">
        <div class="future-bg" style="background-image:url('images/E.jpg')"></div>
        <div class="card-header" style="background:rgba(255,255,255,.8)">
          <div style="font-weight:700">å°†æ¥ Â· FUTURE</div>
          <div id="back-future" class="back-btn">âŸµ è¿”å›ä¸»é¡µé¢</div>
        </div>
        <div class="page-body" style="display:block">
          <div class="future-wrap">
            <div class="typebox">
              <div id="typeText" class="type"></div>
              <div id="passBtn" class="pass">pass</div>

              <!-- ç¬¬äºŒé˜¶æ®µï¼š5 é¡µ -->
              <div id="pages5" class="pages5">
                <div class="p5-wrap">
                  <div id="p5Prev" class="p5-arrow">âŸµ</div>
                  <div id="p5Card" class="p5-card">ç¬¬ 1 é¡µ</div>
                  <div id="p5Next" class="p5-arrow">âŸ¶</div>
                </div>
              </div>

              <!-- ç¬¬ä¸‰é˜¶æ®µï¼šç‚¹èµ -->
              <div id="likeWrap" class="like-wrap" style="place-items:center">
                <div class="like-area">
                  <div id="heart" class="heart">â¤ï¸</div>
                  <div class="count">ç´¯è®¡ç‚¹èµï¼š<span id="likeCount">0</span></div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // â€”â€” å¯¼èˆª/è½¬åœº â€”â€”
    const pages = {
      main: document.getElementById('page-main'),
      now: document.getElementById('page-now'),
      past: document.getElementById('page-past'),
      future: document.getElementById('page-future'),
    };
    const signs = {
      past: document.getElementById('sign-past'),
      now: document.getElementById('sign-now'),
      future: document.getElementById('sign-future'),
    };

    let unlockPast = false;
    let unlockFuture = false;

    function goto(id){
      for(const k in pages){
        const p = pages[k];
        if(p.id===id){ p.classList.add('active'); p.classList.remove('enter','exit'); requestAnimationFrame(()=>p.classList.add('show')); }
        else if(p.classList.contains('active')){ p.classList.remove('show'); p.classList.add('exit'); setTimeout(()=>{p.classList.remove('active'); p.classList.add('enter');}, 620); }
        else{ p.classList.add('enter'); p.classList.remove('show','exit','active'); }
      }
    }

    // ä¸»é¡µé¢è·¯ç‰Œç‚¹å‡»
    document.querySelectorAll('.sign').forEach(el=>{
      el.addEventListener('click', ()=>{
        if(el.classList.contains('locked')) return;
        document.querySelectorAll('.sign').forEach(s=>s.classList.remove('selected'));
        el.classList.add('selected');
        setTimeout(()=>goto(el.dataset.target), 200);
      });
    });

    // è¿”å›æŒ‰é’®
    function showBack(id){ document.getElementById(id).classList.add('show'); }
    function hideBack(id){ document.getElementById(id).classList.remove('show'); }
    document.getElementById('back-now').onclick = ()=>{ goto('page-main'); };
    document.getElementById('back-past').onclick = ()=>{ goto('page-main'); };
    document.getElementById('back-future').onclick = ()=>{ goto('page-main'); };

    // â€”â€” ç°åœ¨é¡µé€»è¾‘ â€”â€”
    const imgA = document.getElementById('imgA');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const toast = document.getElementById('toast');
    let noClicks = 0;

    function popToast(text){
      toast.textContent = text;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 1400);
    }

    noBtn.addEventListener('click', ()=>{
      noClicks++;
      if(noClicks===1){
        noBtn.style.transform='scale(0.95)';
        popToast('çœŸçš„å—ï¼Ÿ');
      }else if(noClicks===2){
        noBtn.style.transform='scale(0.9)';
        yesBtn.style.transform='scale(1.04)';
        popToast('ä½ å†æƒ³æƒ³');
      }else if(noClicks>=3){
        noBtn.style.transform='scale(0.6)';
        noBtn.style.pointerEvents='none';
        noBtn.style.opacity='0.2';
        yesBtn.style.transform='scale(1.12)';
        popToast('å†ç»™ä½ ä¸€æ¬¡æœºä¼š');
      }
    });

    yesBtn.addEventListener('click', ()=>{
      imgA.classList.add('zoom');
      popToast('è€¶ï¼æ¬¢è¿è®¤è¯†æˆ‘');
      const t = document.createElement('div');
      t.textContent = 'æˆ‘ä¹Ÿå¾ˆæƒ³è®¤è¯†å¤§å®¶';
      t.style.position='absolute'; t.style.top='16px'; t.style.left='50%'; t.style.transform='translateX(-50%)';
      t.style.padding='10px 14px'; t.style.background='#fff'; t.style.border='1px solid #e5e7eb'; t.style.borderRadius='12px';
      t.style.boxShadow='0 10px 20px rgba(0,0,0,.08)'; t.style.fontWeight='800'; t.style.opacity='0';
      document.querySelector('#page-now .now-left').appendChild(t);
      setTimeout(()=>{ t.style.transition='opacity .6s, transform .6s'; t.style.opacity='1'; t.style.transform='translateX(-50%) translateY(6px)'; }, 40);

      showBack('back-now');

      // è§£é”ã€Œè¿‡å»ã€
      if(!unlockPast){ unlockPast = true; signs.past.classList.remove('locked'); signs.past.classList.add('active-pulse'); }
    });

    // â€”â€” è¿‡å»é¡µé€»è¾‘ â€”â€”
    const nameInput = document.getElementById('nameInput');
    const nameHint = document.getElementById('nameHint');
    const pastS1 = document.getElementById('past-s1');
    const pastS2 = document.getElementById('past-s2');

    function toPastS2(){
      pastS1.classList.remove('show');
      pastS2.classList.add('show');
      showBack('back-past');
      startCarousel();
    }

    nameInput.addEventListener('change', checkName);
    nameInput.addEventListener('blur', checkName);
    function checkName(){
      const v = (nameInput.value||'').trim();
      if(v==='çŸ³æ˜å¨Ÿ'){ nameHint.textContent=''; toPastS2(); }
      else if(v!==''){ nameHint.textContent='å†è¯•è¯•ï¼Ÿ'; }
    }

    // åˆ†é¡µæ–‡å­—
    const pageTexts = Array.from(document.querySelectorAll('.page-text'));
    const pPrev = document.getElementById('pPrev');
    const pNext = document.getElementById('pNext');
    const pInd  = document.getElementById('pIndicator');
    let pIndex = 0;
    function renderP(){
      pageTexts.forEach((n,i)=>n.classList.toggle('active', i===pIndex));
      pInd.textContent = `${pIndex+1} / ${pageTexts.length}`;
    }
    pPrev.onclick = ()=>{ pIndex = (pIndex-1+pageTexts.length)%pageTexts.length; renderP(); };
    pNext.onclick = ()=>{ pIndex = (pIndex+1)%pageTexts.length; renderP(); };
    renderP();

    // å³ä¾§è½®æ’­ + å®Œæˆåè¿”å› & è§£é”å°†æ¥
    const imgB = document.getElementById('imgB');
    const imgC = document.getElementById('imgC');
    const imgD = document.getElementById('imgD');
    const imgs = [imgB,imgC,imgD];
    let carTimer=null, carIndex=0;

    function showSlide(i){ imgs.forEach((im,idx)=>im.classList.toggle('show', idx===i)); }

    function startCarousel(){
      carIndex=0; showSlide(carIndex);
      clearInterval(carTimer);
      let shownThird = false;
      carTimer = setInterval(()=>{
        carIndex++;
        if(carIndex>=imgs.length){
          clearInterval(carTimer);
          // ç¬¬ 3 å¼ å±•ç¤ºå®Œæ¯•åè¿”å›ä¸»é¡µå¹¶è§£é”å°†æ¥
          setTimeout(()=>{
            goto('page-main');
            if(!unlockFuture){ unlockFuture = true; signs.future.classList.remove('locked'); signs.future.classList.add('active-pulse'); }
          }, 1200);
          return;
        }
        showSlide(carIndex);
      }, 2300); // æ¯å¼  2.3s
    }

    // â€”â€” å°†æ¥é¡µé€»è¾‘ â€”â€”
    const typeEl = document.getElementById('typeText');
    const passBtn = document.getElementById('passBtn');
    const pages5 = document.getElementById('pages5');
    const p5Card = document.getElementById('p5Card');
    const p5Prev = document.getElementById('p5Prev');
    const p5Next = document.getElementById('p5Next');
    const likeWrap = document.getElementById('likeWrap');
    const heart = document.getElementById('heart');
    const likeCount = document.getElementById('likeCount');

    const lines = [
      'ä½ å¥½å‘€ï¼Œæˆ‘æ˜¯ä»Šå¤©çš„ä¸»è§’ï¼šï¼‰',
      'è°¢è°¢ä½ èµ°åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»ç®—æ˜¯æœ‹å‹å•¦ã€‚',
      'ä¸‹é¢æ˜¯å¯¹æœªæ¥çš„ä¸€äº›å°å°æ„¿æœ›â€¦',
    ];

    const fivePages = [
      'åˆšåˆšæ˜¯æ­£ç»çš„è¯´',
      'ç°åœ¨æ˜¯æ›´æ­£ç»çš„äº‹',
      'æˆ‘æƒ³è¦åœ¨æ­¦å¤§è®¤è¯†å¥½å¤šæœ‹å‹ï¼Œç”·å¥³é€šåƒçš„é‚£ç§',
      'æˆ‘æƒ³è¦å’Œä¸€ç¾¤æœ‹å‹æ‹å¾ˆå¤šç…§ç‰‡å’Œè§†é¢‘',
      'æˆ‘æƒ³è¦è€äº†ä¹‹åï¼Œæƒ³åˆ°æ­¦å¤§ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„æ˜¯æˆ‘çš„æœ‹å‹ä»¬',
    ];

    let like = 0, p5Index = 0;

    function typeWriter(lines, cb){
      typeEl.textContent = '';
      let li=0, ch=0;
      function nextChar(){
        if(li>=lines.length){ cb && cb(); return; }
        const line = lines[li];
        if(ch<=line.length){
          typeEl.textContent = lines.slice(0,li).join('\n') + (li? '\n':'') + line.slice(0,ch);
          ch++;
          setTimeout(nextChar, 34); // æ‰“å­—é€Ÿåº¦
        }else{
          li++; ch=0; setTimeout(()=>{ typeEl.textContent += '\n'; setTimeout(nextChar, 500); }, 10);
        }
      }
      nextChar();
    }

    function enterFuture(){
      typeEl.style.display='block'; pages5.classList.remove('show'); likeWrap.classList.remove('show');
      passBtn.classList.remove('show');
      typeWriter(lines, ()=>{
        // å±•ç¤º 5 é¡µ
        p5Index=0; p5Card.textContent = fivePages[p5Index];
        pages5.classList.add('show');
        passBtn.classList.add('show');
      });
    }

    p5Prev.onclick = ()=>{ p5Index = (p5Index-1+fivePages.length)%fivePages.length; p5Card.textContent=fivePages[p5Index]; };
    p5Next.onclick = ()=>{ p5Index = (p5Index+1)%fivePages.length; p5Card.textContent=fivePages[p5Index]; };

    passBtn.onclick = ()=>{
      // è¿›å…¥ç‚¹èµç•Œé¢
      pages5.classList.remove('show'); typeEl.style.display='none'; passBtn.classList.remove('show'); likeWrap.classList.add('show');
    };

    heart.onclick = ()=>{
      like++; likeCount.textContent = like;
      likeCount.parentElement.classList.add('bump');
      setTimeout(()=>likeCount.parentElement.classList.remove('bump'), 260);
      heart.textContent = (heart.textContent==='â¤ï¸') ? 'ğŸ’–' : 'â¤ï¸';
    };

    // å½“è¿›å…¥å„é¡µæ—¶çš„é’©å­ï¼šé‡ç½®å¿…è¦çŠ¶æ€
    const pageObserver = new MutationObserver(()=>{
      // è¿›å…¥ç°åœ¨é¡µæ—¶
      if(pages.now.classList.contains('active')){
        imgA.classList.remove('zoom'); noClicks=0; noBtn.style.transform=''; noBtn.style.pointerEvents=''; noBtn.style.opacity='1'; yesBtn.style.transform='';
      }
      // è¿›å…¥è¿‡å»é¡µæ—¶
      if(pages.past.classList.contains('active')){
        // å›åˆ°åœºæ™¯ä¸€
        pastS2.classList.remove('show'); pastS1.classList.add('show'); nameInput.value=''; nameHint.textContent='';
      }
      // è¿›å…¥å°†æ¥é¡µ
      if(pages.future.classList.contains('active')){
        enterFuture(); showBack('back-future');
      }
      // ä¸»é¡µé¢ï¼šå–æ¶ˆè·¯ç‰Œé«˜äº®
      if(pages.main.classList.contains('active')){
        document.querySelectorAll('.sign').forEach(s=>s.classList.remove('selected'));
        signs.now.classList.add('active-pulse');
        if(unlockPast) signs.past.classList.add('active-pulse');
        if(unlockFuture) signs.future.classList.add('active-pulse');
      }
    });
    pageObserver.observe(document.querySelector('.stage'), {attributes:true, subtree:true, attributeFilter:['class']});
  </script>
</body>
</html>