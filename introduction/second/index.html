<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>开学自我介绍 · 互动网站</title>
  <style>
    :root{
      --bg:#f7fafc;        /* 温柔校园灰白 */
      --ink:#243b53;       /* 深蓝灰文字 */
      --accent:#4f46e5;    /* 校园清新蓝紫 */
      --accent-2:#10b981;  /* 活力绿 */
      --muted:#94a3b8;     /* 次要文本 */
      --card:#ffffff;      /* 卡片底色 */
      --shadow:0 20px 50px rgba(0,0,0,.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0; font-family: "PingFang SC", "Microsoft YaHei", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color:var(--ink); background:linear-gradient(180deg,#eef2ff, #f9fafb 55% , #e6fffa);
      overflow:hidden;
    }

    /* 场景容器（做 3D 翻转转场） */
    .stage{position:relative; width:100vw; height:100vh; perspective:1400px;}
    .page{
      position:absolute; inset:0; display:grid; place-items:center; background:transparent;
      transform-style:preserve-3d; backface-visibility:hidden; opacity:0; pointer-events:none;
      transition:opacity .6s ease, transform .8s cubic-bezier(.2,.8,.2,1);
    }
    .page.active{opacity:1; pointer-events:auto}
    .page.enter{transform:rotateY(-10deg) translateY(10px) scale(.98)}
    .page.show{transform:rotateY(0) translateY(0) scale(1)}
    .page.exit{transform:rotateY(10deg) translateY(10px) scale(.98); opacity:0}

    /* 主页面：十字路口视觉 */
    .main-wrap{
      width:min(1100px,92vw); height:min(680px,86vh); background:var(--card); border-radius:28px; box-shadow:var(--shadow);
      display:grid; grid-template-columns: 1fr; grid-template-rows: 90px 1fr; overflow:hidden; position:relative;
    }
    .main-header{display:flex; align-items:center; justify-content:space-between; padding:18px 26px; background:linear-gradient(90deg,#ffffff, #eef2ff); border-bottom:1px solid #e5e7eb}
    .brand{font-weight:700; letter-spacing:.5px}
    .tip{font-size:14px; color:var(--muted)}

    .crossroads{position:relative; width:100%; height:100%; background:linear-gradient(180deg,#f8fafc, #e0f2fe 60%, #d6d3d1 60%);}
    .path{position:absolute; bottom:0; left:50%; transform:translateX(-50%); width:0; height:0;
      border-left:300px solid transparent; border-right:300px solid transparent; border-top:240px solid #d6d3d1; filter:drop-shadow(0 10px 25px rgba(0,0,0,.15));}
    .path.left{left:30%; border-left-width:220px; border-right-width:60px; border-top-color:#d4d4d4;}
    .path.right{left:70%; border-left-width:60px; border-right-width:220px; border-top-color:#d4d4d4;}

    /* 女孩简笔（CSS 形状轮廓） */
    .girl{position:absolute; bottom:150px; left:50%; transform:translateX(-50%); width:110px; height:220px;}
    .girl .body{position:absolute; bottom:0; left:50%; transform:translateX(-50%); width:80px; height:140px; background:#fefefe; border:2px solid #111827; border-radius:18px 18px 28px 28px/28px 28px 36px 36px; box-shadow:0 8px 16px rgba(0,0,0,.08)}
    .girl .head{position:absolute; bottom:140px; left:50%; transform:translateX(-50%); width:88px; height:88px; background:#fde68a; border:2px solid #111827; border-radius:50%;}
    .girl .skirt{position:absolute; bottom:100px; left:50%; transform:translateX(-50%); width:120px; height:80px; background:#a78bfa; border:2px solid #111827; border-radius:50% 50% 10% 10%; filter:blur(.2px)}
    .girl .shadow{position:absolute; bottom:125px; left:50%; transform:translateX(-50%); width:140px; height:16px; background:radial-gradient(ellipse at center, rgba(0,0,0,.2), rgba(0,0,0,0) 60%);}

    /* 路牌 */
    .signs{position:absolute; top:22%; left:50%; transform:translateX(-50%); display:flex; gap:28px; align-items:flex-end}
    .sign{
      position:relative; width:150px; height:70px; background:#ffffff; border:2px solid #111827; border-radius:16px; display:grid; place-items:center; font-weight:700;
      box-shadow:0 12px 24px rgba(0,0,0,.1); cursor:pointer; transition:transform .25s, box-shadow .25s, filter .25s;
    }
    .sign::after{content:""; position:absolute; bottom:-48px; left:50%; transform:translateX(-50%); width:10px; height:48px; background:#111827; border-radius:4px}
    .sign.locked{cursor:not-allowed; filter:grayscale(1) brightness(.9); opacity:.7}
    .sign:hover:not(.locked){transform:translateY(-4px)}
    .sign.active-pulse{animation:pulse 1.2s ease-in-out infinite}
    @keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(79,70,229,.5)}50%{box-shadow:0 0 0 16px rgba(79,70,229,0)}}
    .sign.selected{transform:scale(1.05); box-shadow:0 0 0 6px rgba(16,185,129,.25), 0 10px 30px rgba(0,0,0,.18)}

    /* 统一卡片布局 */
    .card{width:min(1100px,92vw); height:min(680px,86vh); background:var(--card); border-radius:28px; box-shadow:var(--shadow); overflow:hidden; position:relative}
    .card-header{position:absolute; top:0; left:0; right:0; height:60px; display:flex; align-items:center; justify-content:space-between; padding:0 18px; background:linear-gradient(90deg,#ffffff, #f8fafc); border-bottom:1px solid #eef2f7}
    .back-btn{display:none; align-items:center; gap:8px; font-size:14px; color:var(--accent); cursor:pointer; padding:8px 12px; border-radius:999px; border:1px solid rgba(79,70,229,.25); background:#fff; transition:transform .2s}
    .back-btn.show{display:flex}
    .back-btn:hover{transform:translateY(-1px)}

    .page-body{position:absolute; inset:60px 0 0 0; display:grid; grid-template-columns: 1fr 1fr; height:calc(100% - 60px)}

    /* 现在页 */
    .now-left{position:relative; overflow:hidden; display:grid; place-items:center; background:linear-gradient(180deg,#f0f9ff, #ecfeff)}
    .now-left img{max-width:88%; max-height:88%; border-radius:20px; box-shadow:0 12px 30px rgba(0,0,0,.12); transition:transform .8s ease, filter .8s ease}
    .now-left img.zoom{transform:scale(1.18); filter:contrast(1.1) saturate(1.05)}

    .now-right{padding:24px 28px; display:flex; flex-direction:column; gap:22px; background:linear-gradient(180deg,#ffffff, #f7faff)}
    .q-title{font-size:28px; font-weight:800}
    .btn-row{display:flex; gap:14px}
    .btn{
      padding:14px 20px; border:none; border-radius:14px; background:var(--accent); color:#fff; font-weight:700; cursor:pointer; box-shadow:0 8px 20px rgba(79,70,229,.25); transition:transform .15s ease, box-shadow .2s ease, filter .2s; user-select:none;
    }
    .btn.secondary{background:#e11d48}
    .btn:active{transform:scale(.96)}

    /* 表情包气泡 */
    .toast{position:absolute; right:20px; bottom:20px; padding:10px 14px; background:#fff; border:1px solid #e5e7eb; border-radius:14px; box-shadow:0 10px 20px rgba(0,0,0,.08); opacity:0; transform:translateY(10px); transition:all .35s}
    .toast.show{opacity:1; transform:translateY(0)}

    /* 过去页 */
    .past-scene{display:none; height:100%}
    .past-scene.show{display:grid}
    .past-s1{grid-template-columns:1fr; place-items:center; padding:40px; background:linear-gradient(180deg,#fff, #f0f9ff)}
    .ask{font-size:26px; font-weight:800; margin-bottom:18px}
    .name-input{padding:14px 16px; width:min(520px,80vw); border-radius:14px; border:2px solid #c7d2fe; font-size:18px; outline:none}
    .hint{margin-top:10px; color:#ef4444; min-height:22px}

    .past-s2{grid-template-columns: 1.1fr .9fr; background:linear-gradient(180deg,#ffffff, #f8fafc)}
    .past-left{padding:24px 28px; display:flex; flex-direction:column; gap:14px}
    .pager{flex:1; border:1px dashed #cbd5e1; border-radius:16px; padding:18px; overflow:hidden; position:relative; background:#fff}
    .page-text{position:absolute; inset:0; padding:20px; font-size:18px; line-height:1.8; opacity:0; transform:translateX(8px); transition:opacity .4s, transform .4s}
    .page-text.active{opacity:1; transform:translateX(0)}
    .page-ctr{display:flex; justify-content:space-between; align-items:center}
    .arrow{padding:10px 14px; border-radius:10px; border:1px solid #cbd5e1; background:#fff; cursor:pointer; transition:transform .2s}
    .arrow:hover{transform:translateY(-1px)}

    .past-right{position:relative; display:grid; place-items:center; overflow:hidden}
    .carousel{position:relative; width:88%; height:80%; border-radius:18px; overflow:hidden; box-shadow:0 12px 30px rgba(0,0,0,.12)}
    .carousel img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; opacity:0; transform:scale(1.06) translateX(20px);
      transition:opacity .8s ease, transform 1s ease}
    .carousel img.show{opacity:1; transform:scale(1) translateX(0)}

    /* 将来页 */
    .future-bg{position:absolute; inset:0; background: center/cover no-repeat; filter:brightness(.95)}
    .future-wrap{position:relative; width:100%; height:100%; display:grid; place-items:center}
    .typebox{width:min(780px,86vw); min-height:260px; background:rgba(255,255,255,.9); border:1px solid #e5e7eb; border-radius:20px; box-shadow:var(--shadow); padding:24px 26px; position:relative}
    .type{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size:18px; white-space:pre-line; min-height:120px}
    .pass{position:absolute; right:16px; bottom:14px; font-weight:700; color:#111827; border:1px solid #cbd5e1; background:#fff; padding:8px 14px; border-radius:999px; cursor:pointer; display:none}
    .pass.show{display:inline-block}

    .pages5{display:none}
    .pages5.show{display:block}
    .p5-wrap{display:flex; align-items:center; gap:16px}
    .p5-card{flex:1; min-height:160px; border:1px dashed #cbd5e1; border-radius:16px; padding:18px; background:#fff; display:grid; place-items:center; font-size:22px; font-weight:800; text-align:center}
    .p5-arrow{width:44px; height:44px; border-radius:50%; border:1px solid #cbd5e1; background:#fff; display:grid; place-items:center; cursor:pointer; transition:transform .2s}
    .p5-arrow:hover{transform:scale(1.06)}

    /* 点赞页 */
    .like-wrap{display:none}
    .like-wrap.show{display:grid}
    .like-area{display:grid; place-items:center; gap:18px}
    .heart{font-size:56px; cursor:pointer; user-select:none; transition:transform .15s}
    .heart:active{transform:scale(.94)}
    .count{font-size:38px; font-weight:800}
    .count.bump{animation:bump .25s ease}
    @keyframes bump{0%{transform:translateY(0)}50%{transform:translateY(-4px)}100%{transform:translateY(0)}}

    /* 响应式 */
    @media (max-width: 900px){
      .page-body{grid-template-columns:1fr}
      .past-s2{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="stage">
    <!-- 主页面 -->
    <section id="page-main" class="page active show">
      <div class="main-wrap">
        <div class="main-header">
          <div class="brand">👋 自我介绍 · Welcome!</div>
          <div class="tip">选择一条路，了解我的 <b>过去 / 现在 / 将来</b></div>
        </div>
        <div class="crossroads">
          <div class="path left"></div>
          <div class="path"></div>
          <div class="path right"></div>

          <div class="girl">
            <div class="shadow"></div>
            <div class="body"></div>
            <div class="skirt"></div>
            <div class="head"></div>
          </div>

          <div class="signs">
            <div id="sign-past" class="sign locked" data-target="page-past">过去</div>
            <div id="sign-now" class="sign active-pulse" data-target="page-now">现在</div>
            <div id="sign-future" class="sign locked" data-target="page-future">将来</div>
          </div>
        </div>
      </div>
    </section>

    <!-- 现在页 -->
    <section id="page-now" class="page enter">
      <div class="card">
        <div class="card-header">
          <div style="font-weight:700">现在 · NOW</div>
          <div id="back-now" class="back-btn">⟵ 返回主页面</div>
        </div>
        <div class="page-body">
          <div class="now-left">
            <img id="imgA" src="images/A.jpg" alt="A" />
          </div>
          <div class="now-right">
            <div class="q-title">你想认识我吗？</div>
            <div class="btn-row">
              <button id="yesBtn" class="btn">想</button>
              <button id="noBtn" class="btn secondary">不想</button>
            </div>
            <div style="color:var(--muted)">小提示：选择不同，会触发不同的动画噢～</div>
          </div>
          <div id="toast" class="toast"></div>
        </div>
      </div>
    </section>

    <!-- 过去页 -->
    <section id="page-past" class="page enter">
      <div class="card">
        <div class="card-header">
          <div style="font-weight:700">过去 · PAST</div>
          <div id="back-past" class="back-btn">⟵ 返回主页面</div>
        </div>

        <!-- 场景一：输入名字 -->
        <div id="past-s1" class="page-body past-scene past-s1 show">
          <div style="display:grid; place-items:center; height:100%">
            <div class="ask">我叫什么名字？</div>
            <input id="nameInput" class="name-input" placeholder="请输入：石明娟" />
            <div id="nameHint" class="hint"></div>
          </div>
        </div>

        <!-- 场景二：分页 + 轮播 -->
        <div id="past-s2" class="page-body past-scene past-s2">
          <div class="past-left">
            <div class="pager">
              <div class="page-text" data-i="0">嗨，我从小在校园里长大，热爱社团活动与记录生活。</div>
              <div class="page-text" data-i="1">喜欢拍照、运动和分享故事，也擅长做活动策划。</div>
              <div class="page-text" data-i="2">来到新的环境，我希望和大家成为彼此的光。</div>
            </div>
            <div class="page-ctr">
              <button id="pPrev" class="arrow">⟵ 上一页</button>
              <div id="pIndicator" style="color:var(--muted)">1 / 3</div>
              <button id="pNext" class="arrow">下一页 ⟶</button>
            </div>
          </div>
          <div class="past-right">
            <div class="carousel">
              <img id="imgB" src="images/B.jpg" alt="B" />
              <img id="imgC" src="images/C.jpg" alt="C" />
              <img id="imgD" src="images/D.jpg" alt="D" />
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 将来页 -->
    <section id="page-future" class="page enter">
      <div class="card" style="background:transparent">
        <div class="future-bg" style="background-image:url('images/E.jpg')"></div>
        <div class="card-header" style="background:rgba(255,255,255,.8)">
          <div style="font-weight:700">将来 · FUTURE</div>
          <div id="back-future" class="back-btn">⟵ 返回主页面</div>
        </div>
        <div class="page-body" style="display:block">
          <div class="future-wrap">
            <div class="typebox">
              <div id="typeText" class="type"></div>
              <div id="passBtn" class="pass">pass</div>

              <!-- 第二阶段：5 页 -->
              <div id="pages5" class="pages5">
                <div class="p5-wrap">
                  <div id="p5Prev" class="p5-arrow">⟵</div>
                  <div id="p5Card" class="p5-card">第 1 页</div>
                  <div id="p5Next" class="p5-arrow">⟶</div>
                </div>
              </div>

              <!-- 第三阶段：点赞 -->
              <div id="likeWrap" class="like-wrap" style="place-items:center">
                <div class="like-area">
                  <div id="heart" class="heart">❤️</div>
                  <div class="count">累计点赞：<span id="likeCount">0</span></div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // —— 导航/转场 ——
    const pages = {
      main: document.getElementById('page-main'),
      now: document.getElementById('page-now'),
      past: document.getElementById('page-past'),
      future: document.getElementById('page-future'),
    };
    const signs = {
      past: document.getElementById('sign-past'),
      now: document.getElementById('sign-now'),
      future: document.getElementById('sign-future'),
    };

    let unlockPast = false;
    let unlockFuture = false;

    function goto(id){
      for(const k in pages){
        const p = pages[k];
        if(p.id===id){ p.classList.add('active'); p.classList.remove('enter','exit'); requestAnimationFrame(()=>p.classList.add('show')); }
        else if(p.classList.contains('active')){ p.classList.remove('show'); p.classList.add('exit'); setTimeout(()=>{p.classList.remove('active'); p.classList.add('enter');}, 620); }
        else{ p.classList.add('enter'); p.classList.remove('show','exit','active'); }
      }
    }

    // 主页面路牌点击
    document.querySelectorAll('.sign').forEach(el=>{
      el.addEventListener('click', ()=>{
        if(el.classList.contains('locked')) return;
        document.querySelectorAll('.sign').forEach(s=>s.classList.remove('selected'));
        el.classList.add('selected');
        setTimeout(()=>goto(el.dataset.target), 200);
      });
    });

    // 返回按钮
    function showBack(id){ document.getElementById(id).classList.add('show'); }
    function hideBack(id){ document.getElementById(id).classList.remove('show'); }
    document.getElementById('back-now').onclick = ()=>{ goto('page-main'); };
    document.getElementById('back-past').onclick = ()=>{ goto('page-main'); };
    document.getElementById('back-future').onclick = ()=>{ goto('page-main'); };

    // —— 现在页逻辑 ——
    const imgA = document.getElementById('imgA');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const toast = document.getElementById('toast');
    let noClicks = 0;

    function popToast(text){
      toast.textContent = text;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 1400);
    }

    noBtn.addEventListener('click', ()=>{
      noClicks++;
      if(noClicks===1){
        noBtn.style.transform='scale(0.95)';
        popToast('真的吗？');
      }else if(noClicks===2){
        noBtn.style.transform='scale(0.9)';
        yesBtn.style.transform='scale(1.04)';
        popToast('你再想想');
      }else if(noClicks>=3){
        noBtn.style.transform='scale(0.6)';
        noBtn.style.pointerEvents='none';
        noBtn.style.opacity='0.2';
        yesBtn.style.transform='scale(1.12)';
        popToast('再给你一次机会');
      }
    });

    yesBtn.addEventListener('click', ()=>{
      imgA.classList.add('zoom');
      popToast('耶！欢迎认识我');
      const t = document.createElement('div');
      t.textContent = '我也很想认识大家';
      t.style.position='absolute'; t.style.top='16px'; t.style.left='50%'; t.style.transform='translateX(-50%)';
      t.style.padding='10px 14px'; t.style.background='#fff'; t.style.border='1px solid #e5e7eb'; t.style.borderRadius='12px';
      t.style.boxShadow='0 10px 20px rgba(0,0,0,.08)'; t.style.fontWeight='800'; t.style.opacity='0';
      document.querySelector('#page-now .now-left').appendChild(t);
      setTimeout(()=>{ t.style.transition='opacity .6s, transform .6s'; t.style.opacity='1'; t.style.transform='translateX(-50%) translateY(6px)'; }, 40);

      showBack('back-now');

      // 解锁「过去」
      if(!unlockPast){ unlockPast = true; signs.past.classList.remove('locked'); signs.past.classList.add('active-pulse'); }
    });

    // —— 过去页逻辑 ——
    const nameInput = document.getElementById('nameInput');
    const nameHint = document.getElementById('nameHint');
    const pastS1 = document.getElementById('past-s1');
    const pastS2 = document.getElementById('past-s2');

    function toPastS2(){
      pastS1.classList.remove('show');
      pastS2.classList.add('show');
      showBack('back-past');
      startCarousel();
    }

    nameInput.addEventListener('change', checkName);
    nameInput.addEventListener('blur', checkName);
    function checkName(){
      const v = (nameInput.value||'').trim();
      if(v==='石明娟'){ nameHint.textContent=''; toPastS2(); }
      else if(v!==''){ nameHint.textContent='再试试？'; }
    }

    // 分页文字
    const pageTexts = Array.from(document.querySelectorAll('.page-text'));
    const pPrev = document.getElementById('pPrev');
    const pNext = document.getElementById('pNext');
    const pInd  = document.getElementById('pIndicator');
    let pIndex = 0;
    function renderP(){
      pageTexts.forEach((n,i)=>n.classList.toggle('active', i===pIndex));
      pInd.textContent = `${pIndex+1} / ${pageTexts.length}`;
    }
    pPrev.onclick = ()=>{ pIndex = (pIndex-1+pageTexts.length)%pageTexts.length; renderP(); };
    pNext.onclick = ()=>{ pIndex = (pIndex+1)%pageTexts.length; renderP(); };
    renderP();

    // 右侧轮播 + 完成后返回 & 解锁将来
    const imgB = document.getElementById('imgB');
    const imgC = document.getElementById('imgC');
    const imgD = document.getElementById('imgD');
    const imgs = [imgB,imgC,imgD];
    let carTimer=null, carIndex=0;

    function showSlide(i){ imgs.forEach((im,idx)=>im.classList.toggle('show', idx===i)); }

    function startCarousel(){
      carIndex=0; showSlide(carIndex);
      clearInterval(carTimer);
      let shownThird = false;
      carTimer = setInterval(()=>{
        carIndex++;
        if(carIndex>=imgs.length){
          clearInterval(carTimer);
          // 第 3 张展示完毕后返回主页并解锁将来
          setTimeout(()=>{
            goto('page-main');
            if(!unlockFuture){ unlockFuture = true; signs.future.classList.remove('locked'); signs.future.classList.add('active-pulse'); }
          }, 1200);
          return;
        }
        showSlide(carIndex);
      }, 2300); // 每张 2.3s
    }

    // —— 将来页逻辑 ——
    const typeEl = document.getElementById('typeText');
    const passBtn = document.getElementById('passBtn');
    const pages5 = document.getElementById('pages5');
    const p5Card = document.getElementById('p5Card');
    const p5Prev = document.getElementById('p5Prev');
    const p5Next = document.getElementById('p5Next');
    const likeWrap = document.getElementById('likeWrap');
    const heart = document.getElementById('heart');
    const likeCount = document.getElementById('likeCount');

    const lines = [
      '你好呀，我是今天的主角：）',
      '谢谢你走到这里，我们已经算是朋友啦。',
      '下面是对未来的一些小小愿望…',
    ];

    const fivePages = [
      '刚刚是正经的说',
      '现在是更正经的事',
      '我想要在武大认识好多朋友，男女通吃的那种',
      '我想要和一群朋友拍很多照片和视频',
      '我想要老了之后，想到武大第一个想到的是我的朋友们',
    ];

    let like = 0, p5Index = 0;

    function typeWriter(lines, cb){
      typeEl.textContent = '';
      let li=0, ch=0;
      function nextChar(){
        if(li>=lines.length){ cb && cb(); return; }
        const line = lines[li];
        if(ch<=line.length){
          typeEl.textContent = lines.slice(0,li).join('\n') + (li? '\n':'') + line.slice(0,ch);
          ch++;
          setTimeout(nextChar, 34); // 打字速度
        }else{
          li++; ch=0; setTimeout(()=>{ typeEl.textContent += '\n'; setTimeout(nextChar, 500); }, 10);
        }
      }
      nextChar();
    }

    function enterFuture(){
      typeEl.style.display='block'; pages5.classList.remove('show'); likeWrap.classList.remove('show');
      passBtn.classList.remove('show');
      typeWriter(lines, ()=>{
        // 展示 5 页
        p5Index=0; p5Card.textContent = fivePages[p5Index];
        pages5.classList.add('show');
        passBtn.classList.add('show');
      });
    }

    p5Prev.onclick = ()=>{ p5Index = (p5Index-1+fivePages.length)%fivePages.length; p5Card.textContent=fivePages[p5Index]; };
    p5Next.onclick = ()=>{ p5Index = (p5Index+1)%fivePages.length; p5Card.textContent=fivePages[p5Index]; };

    passBtn.onclick = ()=>{
      // 进入点赞界面
      pages5.classList.remove('show'); typeEl.style.display='none'; passBtn.classList.remove('show'); likeWrap.classList.add('show');
    };

    heart.onclick = ()=>{
      like++; likeCount.textContent = like;
      likeCount.parentElement.classList.add('bump');
      setTimeout(()=>likeCount.parentElement.classList.remove('bump'), 260);
      heart.textContent = (heart.textContent==='❤️') ? '💖' : '❤️';
    };

    // 当进入各页时的钩子：重置必要状态
    const pageObserver = new MutationObserver(()=>{
      // 进入现在页时
      if(pages.now.classList.contains('active')){
        imgA.classList.remove('zoom'); noClicks=0; noBtn.style.transform=''; noBtn.style.pointerEvents=''; noBtn.style.opacity='1'; yesBtn.style.transform='';
      }
      // 进入过去页时
      if(pages.past.classList.contains('active')){
        // 回到场景一
        pastS2.classList.remove('show'); pastS1.classList.add('show'); nameInput.value=''; nameHint.textContent='';
      }
      // 进入将来页
      if(pages.future.classList.contains('active')){
        enterFuture(); showBack('back-future');
      }
      // 主页面：取消路牌高亮
      if(pages.main.classList.contains('active')){
        document.querySelectorAll('.sign').forEach(s=>s.classList.remove('selected'));
        signs.now.classList.add('active-pulse');
        if(unlockPast) signs.past.classList.add('active-pulse');
        if(unlockFuture) signs.future.classList.add('active-pulse');
      }
    });
    pageObserver.observe(document.querySelector('.stage'), {attributes:true, subtree:true, attributeFilter:['class']});
  </script>
</body>
</html>